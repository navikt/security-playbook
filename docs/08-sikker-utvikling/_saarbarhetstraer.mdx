<details>
<summary><b>Eksterne aktører</b></summary>

For eksterne aktører ser vi for oss disse sårbarhetene:

<details>
<summary>Autentisering</summary>

```mermaid
graph TD;
    AUTH[Autentisering]-->MANGEL[Manglende autentisering];
    MANGEL-->MANGEL_STD[Standardkonto];
    MANGEL-->MANGEL_ENP[Endepunkter uten autentisering];
    MANGEL-->MANGEL_VAL[Validerer ikke token];

    AUTH-->SVAK[Svak autentisering];
    SVAK-->SVAK_STD[Har endepunkter som ikke bruker AD/ID-porten];

    AUTH-->LEKK[Lekker passord/tokens];
    LEKK-->LEKKER[Committer passord/token i kode];
    LEKK-->LOKALT[Passord/token i klartekst lokalt];
```

</details>

<details>
<summary>Logging og overvåkning</summary>

```mermaid
graph TD;
    LOGG[Logging og overvåking]-->MANGEL[Manglfull logging];
    LOGG-->SENS[Logger sensitiv informasjon];
    LOGG-->MON[Overvåker ikke for unormal aktivitet];
    LOGG-->SCAN_AV[Sårbarhetsskanning er ikke skrudd på];
    LOGG-->SCAN_FUNN[Sårbarheter blir ikke håndtert];
```

</details>

<details>
<summary>Annet</summary>

```mermaid
graph TD;
    ANNET[Annet? Noe vi har glemt?];
```

</details>

</details>

<details>
<summary><b>Prosesser</b></summary>

For prosesser ser vi for oss disse sårbarhetene:

<details>
<summary>Logging og overvåkning</summary>

```mermaid
graph TD;
    LOGG[Logging og overvåking]-->MANGEL[Manglfull logging];
    LOGG-->SENS[Oppdager ikke logging av sensitiv informasjon];
    LOGG-->TVE[Tvetydige eller uklare logger];
    LOGG-->MON[Overvåker ikke for unormal aktivitet];
    LOGG-->VARSL[Manglende varsling ved feil];
    LOGG-->LOKALT[Logger lagres kun lokalt];
```

</details>

<details>
<summary>Integritet</summary>

```mermaid
graph TD;
    INT[Integritet]-->MANGEL[Manglende bruk av digitale signaturer];
```

</details>

<details>
<summary>Kryptografi</summary>

```mermaid
graph TD;
    KRYPT[Kryptografi]-->MANGEL[Validerer ikke token/JWT];
    KRYPT-->FEIL[Validerer ikke token/JWT korrekt];
    KRYPT-->SVAK[Buker svake krypteringsalgoritmer];
    KRYPT-->STD[Bruker standardnøkler eller svake nøkler];
```

</details>

<details>
<summary>Avhengigheter og programvare</summary>

```mermaid
graph TD;
    AVHENG[Avhengigheter og programvare]-->Fei[Oppdager ikke sikkerhetsfeil i egen kode];
    AVHENG-->SARB[Sårbarheter i avhengigheter og avhengighetskjede];
    AVHENG-->OPPDAG[Oppdager ikke CVE i avhengigheter];
    AVHENG-->DOCKER[Oppdager ikke sårbarheter i docker-image];
    AVHENG-->HAND[Håndterer ikke sårbarhetene];
    AVHENG-->CI[CI/CD-pipeline er ikke konfigurert riktig];
```

</details>

<details>
<summary>Input</summary>

```mermaid
graph TD;
    INPUT[Input]-->MANGL[Manglende test av alle parametere];
    INPUT-->VAL[Feil i validering filtrering, sanetisering av input];
```

</details>

<details>
<summary>Annet?</summary>

```mermaid
graph TD;
    ANNET[Annet?]-->DELER[Deler ressurser med andre applikasjoner];
```

</details>

</details>

<details>
<summary><b>Data og lagring</b></summary>

For data og lagring ser vi for oss disse sårbarhetene:

<details>
<summary>Autentisering</summary>

```mermaid
graph TD;
    AUTH[Autentisering]-->TILG[Manglende tilgangsstyring - Brukere - Programvare - Konsumenter Etc.];
    AUTH-->MANGEL[Manglende autentisering];
    AUTH-->STD[Standardkonto];
    AUTH-->APENT[Hemligheter ligger åpent i kode];
    AUTH-->LOKALT[Hemligheter ligger åpent lokalt];
```

</details>

<details>
<summary>Tjenestenekt</summary>

```mermaid
graph TD;
    TJEN[Tjenestenekt]-->PROC[Nekte tilgang til prosesser];
    TJEN-->FULT[Fult lagringsmedium];
```

</details>

<details>
<summary>Logging og overvåkning</summary>

```mermaid
graph TD;
    LOG[Logging og overvåkning]-->USYNC[Usynkroniserte logger på tvers av systemer];
```

</details>

<details>
<summary>Konfidensialitet</summary>

```mermaid
graph TD;
    KONF[Konfidensialitet]-->MANGEL[Manglende kryptering];
    KONF-->HASH[Manglende hashing eller bruk av svake algoritmer];
    KONF-->BACKUP[Backup er ikke testet];
    KONF-->LEKK[Metadata lekker data f.eks. filsystem];
```

</details>

<details>
<summary>Annet?</summary>

```mermaid
graph TD;
    ANNET[Noe vi har glemt?];
```

</details>

</details>

<details>
<summary><b>Dataflyt</b></summary>

For dataflyt ser vi for oss disse sårbarhetene:

<details>
<summary>Autentisering</summary>

```mermaid
graph TD;
    TJEN[Autentisering]-->RATE[Usikre protokoller];
```

</details>

<details>
<summary>Tjenestenekt</summary>

```mermaid
graph TD;
    TJEN[Tjenestenekt]-->RATE[Manglende rate  limiting];
    TJEN-->FALLOVER[Manglende failover ved utilgjengelig endepunkt];
```

</details>

<details>
<summary>Konfidensialitet</summary>

```mermaid
graph TD;
    KONF[Konfidensialitet]-->MANGEL[Manglende kryptering];
    KONF-->API[API lekker data];
```

</details>

<details>
<summary>Annet?</summary>

```mermaid
graph TD;
    ANNET[Annet?]-->NET[Manglende nettverkssegmentering];
```

</details>

</details>
